#: import FadeTransition kivy.uix.screenmanager.FadeTransition

Windows:
    MainScreen:
    PassengerSP:
    PassengerLog:
    PassengerHome:
    ForgotpwdPas:
    ChpwdPass:
    AdvanceBooking:
    Profileviewer:
    RideDetailsScreen:
    AdvancedRideDetailsScreen:
    CancellationScreen:
    Chatscreen:
    ViewRides:
    DriverChat:
    AdvancedDriverChat:

<ViewRides>:
    name: 'viewrides'
    
    BoxLayout:
    	orientation: 'horizontal'
        BoxLayout:
            orientation: 'vertical'
            size_hint: 0.1, 1
            spacing: 10
            canvas.before:
            	Color:
            	    rgba: 0.95, 0.95, 0.95, 1  # Background color
            	Rectangle:
                	pos: self.pos
                	size: self.size
            Button:
                text: 'Home'
                size_hint: 1, 0.1
                background_color: (1, 0.2, 0.2, 1)
                color: (1, 1, 1, 1)
                on_release: 
                    root._reset_()
                    app.root.current= 'Phome'
            Button:
                text: 'Profile'
                size_hint: 1, 0.1
                background_color: (1, 0.2, 0.2, 1)
                color: (1, 1, 1, 1)
                on_release: 
                    root._reset_()
                    app.root.current= 'profile'
            Label:
                text: ''
                size_hint: 1, 0.7
            Button:
                text: 'Logout'
                size_hint: 1, 0.1
                background_color: (1, 0.2, 0.2, 1)
                color: (1, 1, 1, 1)
                on_release: app.root.current= 'main'
        CustomMapView:
            id: passmap
            size_hint: 0.6, 1
            zoom: 12
            lat: 13.0827
            lon: 80.2707
            MapMarker:
                id: pickupmarker
                lat: 0 #13.069344
                lon: 0 #80.195203
                size: '2dp', '2dp'
                size_hint: 0.1,0.1
                source: "pickup_pointer.png"
            MapMarker:
                id: destinationmarker
                lat: 0 #13.0827
                lon: 0 #80.2707
                size: '2dp', '2dp'
                size_hint: 0.1, 0.1
            	source: "destination_pointer.png"	
    	BoxLayout:
            id: detailslay
    	    orientation: 'vertical'
    	    size_hint: 0.3, 1
    	    padding: [20]
    	    spacing: 10
            
    	    canvas.before:
            	Color:
            	    rgba: 0.95, 0.95, 0.95, 1  # Background color
            	Rectangle:
                	pos: self.pos
                	size: self.size
    	    Label:
                text: '[b]Ride Details[/b]'
                size_hint: 1, 0.1
                markup: True
                font_size: 24
                color: 0.1, 0.1, 0.1, 1

            BoxLayout:
                orientation: 'vertical'
                size_hint: 1, 0.8
                spacing: 5
                padding: [10, 0, 10, 0]

                Label:
                    id: dname
                    text: ''
                    size_hint: 1, 0.1
                    halign: 'center'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1
                    bold: True

                Label:
                    id: dvehicletype
                    text: ''
                    size_hint: 1, 0.1
                    halign: 'center'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1

                Label:
                    id: dvehicleno
                    text: ''
                    size_hint: 1, 0.1
                    halign: 'center'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1
                    bold: True

                Label:
                    id: driver_phone
                    text: 'Phone: '
                    size_hint: 1, 0.1
                    halign: 'center'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1
                    bold: True

                Label:
                    text: ''
                    size_hint: 1, 0.1


                Label:
                    id: otp
                    text: ''
                    size_hint: 1, 0.2
                    font_size: "30sp"
                    halign: 'center'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1
                    markup: True

                Label:
                    text: ''
                    size_hint: 1, 0.15

                Label:
                    id: pickup
                    text: 'Pickup: '
                    size_hint: 1, 0.1
                    halign: 'left'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1

                Label:
                    id: destination
                    text: 'Destination: '
                    size_hint: 1, 0.1
                    halign: 'left'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1

                Label:
                    text: ''
                    size_hint: 1, 0.1

                Label:
                    id: price
                    text: 'Total Price: '
                    size_hint: 1, 0.05
                    halign: 'left'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1
                
                Label:
                    id: errormsg
                    text: ''
                    size_hint: 1, 0.1

                BoxLayout:
                    id: options_lay
                    orientation: 'vertical'
                    size_hint: 1, 0.1
                    spacing: 5

<DriverChat>:
    name: 'driverchat'

<AdvancedDriverChat>:
    name: 'advanceddriverchat'

<Chatscreen>:
    name: "chat"

<MainScreen>:
    name: "main"
    canvas:
        Rectangle:
            pos: self.pos
            size: self.size
            source: 'background.jpg'
    orientation: 'vertical'
    GridLayout:
        cols: 1
        BoxLayout:
            size_hint: 1, 0.3
            orientation: 'vertical'
            Image:
                source: 'logo.png' 
                allow_stretch: True
                keep_ratio: True
                size_hint: 1, 0.7
            Label:
                text: "  Welcome to EzCabz"
                font_size: "50dp"
                font: 'consalas'
                bold: True
                color: [1,0,0,1]
                size_hint: 1, 0.3
        Label:
            size_hint: 1, 0.4
            text: ''
        BoxLayout:
            orientation: 'horizontal'
            padding: [30]
            spacing: 20
            size_hint: 1, 0.3
            RoundedButton:
                text: "SignUp"
                size_hint: 0.2, 0.8
                bold: True
                font_size: "30dp"
                on_release: 
                    root.manager.transition = FadeTransition()
                    app.root.current = "Psignup"
            Label:
                size_hint: 0.6, 0.8
                text: ''
            RoundedButton:
                text: "Login"
                size_hint: 0.2, 0.8
                bold: True
                font_size: "30dp"
                on_release: 
                    root.manager.transition = FadeTransition()
                    app.root.current = "Plogin"

<PassengerLog>:
    name: 'Plogin'
    canvas:
        Rectangle:
            pos: self.pos
            size: self.size
            source: 'background2.jpg'
    orientation: 'vertical'
    AnchorLayout:
        anchor_x: 'center'
        spacing: 40
        BoxLayout:
            orientation: 'vertical'
            padding: 50,50
            spacing: 40
            Image:
                source: 'logo.png' 
                allow_stretch: True
                keep_ratio: True
                size_hint: 1, 0.2
            Label:
                text: "LOGIN"
                font_size: "50dp"
                bold: True
                color: [1,0,0,1]
                size_hint: 1, 0.1
            GridLayout:
                cols: 2
                size_hint: 1, 0.4
                Label:
                    text: 'Email'
                    size_hint: 0.3, 1
                    color: [0,0,0,1]
                    font_size: "30dp"
                    bold: True
                TextInput:
                    id: email
                    multiline: False
                    font_size: "25dp"
                    hint_text: "yourmail@gmail.com"
                    background_color: 0.8, 0.8, 0.8, 0.6
                    on_double_tap: root.__recent__(email, pwd)
                Label:
                    text: "Password"
                    size_hint: 0.3, 1
                    color: [0,0,0,1]
                    font_size: "30dp"
                    bold: True
                TextInput:
                    id: pwd
                    password: True
                    font_size: "25dp"
                    hint_text: "your password"
                    background_color: 0.8, 0.8, 0.8, 0.6
                    allow_copy: False
                Label:
                    text: "OTP"
                    bold: True
                    color: [0,0,0,1]
                    font_size: "30dp"
                    hint_text: "Click 'Send OTP' button to verify"
                    size_hint: 0.3, 1
                TextInput:
                    id: otp
                    multiline: False
                    font_size: "25dp"
                    password: True
                    background_color: 0.8, 0.8, 0.8, 0.6
                    #background_color: 0,0,0,0
                    #foreground_color: 1,1,1,1
            BoxLayout:
                orientation: 'horizontal'
                spacing: 20
                padding: [30]
                size_hint: 1, 0.3
                Button:
                    text: "Go back"
                    size_hint: 0.5, 0.3
                    font_size: "20sp"
                    bold: True
                    color: 1,0,0,1
                    background_color: 0,0,0,0.5
                    on_release: app.root.current = 'main'
                Button:
                    text: "Send OTP"
                    size_hint: 0.5, 0.3
                    font_size: "20sp"
                    bold: True
                    color: 1,0,0,1
                    background_color: 0,0,0,0.5
                    on_press: root.__submit__(email.text, pwd.text, errormsg)
                Label:
                    id: errormsg
                    text: ''
                Button:
                    text: 'Forgot Password'
                    size_hint: 0.8, 0.3
                    font_size: "20sp"
                    bold: True
                    color: 1,0,0,1
                    background_color: 0,0,0,0.5
                    on_release: app.root.current= 'FPpass'
                Button:
                    text: 'Submit'
                    size_hint: 0.5, 0.3
                    font_size: "20sp"
                    bold: True
                    color: 1,0,0,1
                    background_color: 0,0,0,0.5
                    on_press: root.__verify__(otp.text, errormsg)

<PassengerSP>:
    name: 'Psignup'
    canvas:
        Rectangle:
            pos: self.pos
            size: self.size
            source: 'background2.jpg'
    orientation: 'vertical'
    BoxLayout:
        orientation: 'vertical'
        spacing: 20
        padding: [40]
        Image:
            source: 'logo.png' 
            allow_stretch: True
            keep_ratio: True
            size_hint: 1, 0.2
        Label:
            text: "SIGN UP"
            font_size: "50dp"
            bold: True
            color: [1,0,0,1]
            size_hint: 1, 0.1
        GridLayout:
            size_hint: 1, 0.45
            cols: 2
            Label:
                text: "Name"
                size_hint: 0.5, 1
                color: [0,0,0,1]
                font_size: "30dp"
                bold: True
            TextInput:
                id: name
                multiline: False
                bold: True
                color: [0,0,0,1]
                background_color: 0.8, 0.8, 0.8, 0.6
                font_size: "30dp"
                hint_text: "your name"
            Label:
                text: "Email ID"
                size_hint: 0.5, 1
                color: [0,0,0,1]
                font_size: "30dp"
                bold: True
            TextInput:
                id: email
                multiline: False
                bold: True
                background_color: 0.8, 0.8, 0.8, 0.6
                color: [0,0,0,1]
                font_size: "30dp"
                hint_text: "example@gmail.com"
            Label:
                text: "Phone Number"
                size_hint: 0.5, 1
                color: [0,0,0,1]
                font_size: "30dp"
                bold: True
            TextInput:
                id: phone
                multilline: False
                bold: True
                background_color: 0.8, 0.8, 0.8, 0.6
                color: [0,0,0,1]
                font_size: "30dp"
                hint_text: "1234567890"
            Label:
                text: "Password"
                size_hint: 0.5, 1
                color: [0,0,0,1]
                font_size: "30dp"
                bold: True
            TextInput:
                id: pwd
                password: True
                bold: True
                background_color: 0.8, 0.8, 0.8, 0.6
                color: [0,0,0,1]
                font_size: "30dp"
                multiline: False
            Label:
                text: "Confirm password"
                size_hint: 0.5, 1
                color: [0,0,0,1]
                font_size: "30dp"
                bold: True
            TextInput:
                id: cpwd
                password: True
                bold: True
                color: [0,0,0,1]
                background_color: 0.8, 0.8, 0.8, 0.6
                font_size: "30dp"
                multiline: False
            Label:
                text: "OTP"
                size_hint: 0.5, 1
                color: [0,0,0,1]
                font_size: "30dp"
                bold: True
            TextInput:
                id: otp
                multiline: False
                bold: True
                background_color: 0.8, 0.8, 0.8, 0.6
                color: [0,0,0,1]
                font_size: "30dp"
                password: True
        BoxLayout:
            orientation: 'horizontal'
            spacing: 20
            size_hint: 1, 0.15
            Button:
                text: 'Send OTP'
                size_hint: 0.5, 0.3
                font_size: "20sp"
                bold: True
                color: 1,0,0,1
                background_color: 0,0,0,0.5
                on_release: 
                    root.__enter_data__(name.text, phone.text,email.text, pwd.text, cpwd.text, errormsg)
            Label:
                id: errormsg
                size_hint: 0.5, 0.3
                color: [0,0,0,1]
                bold: True
                text: 'Please fill all fields\n      correctly.'
                
            Button:
                text: "Submit"
                size_hint: 0.5, 0.3
                font_size: "20sp"
                bold: True
                color: 1,0,0,1
                background_color: 0,0,0,0.5
                on_press: 
                    root.verify_otp(otp.text, errormsg)
            Button:
                text: "Go Back"
                size_hint: 0.5, 0.3
                font_size: "20sp"
                bold: True
                color: 1,0,0,1
                background_color: 0,0,0,0.5
                on_release:
                    app.root.current = "main"

<ForgotpwdPas>:
    name: 'FPpass'
    canvas:
        Rectangle:
            pos: self.pos
            size: self.size
            source: 'background.jpg'
    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'center'
        spacing: 30
        padding: [30]
        BoxLayout:
            orientation: 'vertical'
            size_hint: 0.8, 0.8
            pos_hint_x: {'center_x'}
            Label:
                text: 'Enter Your details'
            GridLayout:
                cols: 2
                spacing: 20
                size_hint: 0.9, 0.7
                Label:
                    text: 'Email ID'
                    size_hint: 0.1, 0.5
                TextInput:
                    id: email
                    size_hint: 1, 0.5
                Label:
                    text: 'OTP'
                    size_hint: 0.1, 0.5
                TextInput:
                    id: otp
                    size_hint: 1, 0.5
                    password: True
            BoxLayout:
                orientation: 'horizontal'
                spacing: 10
                Button:
                    text: 'Go Back'
                    size_hint: 0.5, 0.3
                    on_release: app.root.current= 'Plogin'
                Button:
                    text: 'Send OTP'
                    size_hint: 0.5, 0.3
                    on_press: root.__verify__(email.text, errormsg)
                Label:
                    id: errormsg
                    text: ''
                Button:
                    text: 'Submit'
                    size_hint: 0.5, 0.3
                    on_press: root.change_pwd(otp.text, errormsg)
<Profileviewer>:
    name: 'profile'	
    BoxLayout:
        orientation: 'vertical'
        spacing: dp(10)
        padding: dp(20)
        canvas.before:
            Color:
                rgba: 0.95, 0.95, 0.95, 1  # Background color
            Rectangle:
                pos: self.pos
                size: self.size

        BoxLayout:
            orientation: 'horizontal'
            size_hint: 0.8, 0.3
            spacing: dp(20)
            padding: [dp(30)]
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
            canvas.before:
                Color:
                    rgba: 0.2, 0.6, 0.8, 1  # Header background color
                Rectangle:
                    pos: self.pos
                    size: self.size
            
            Image:
                source: 'profile.png'
                size_hint: 0.3, 1
                allow_stretch: True
                keep_ratio: True

            BoxLayout:
                orientation: 'vertical'
                size_hint: 0.5, 1
                spacing: dp(10)

                Label:
                    id: name
                    text: '[b]Name Placeholder[/b]'
                    font_size: '36sp'
                    markup: True
                    halign: 'left'
                    valign: 'middle'
                    text_size: self.size
                    color: 1, 1, 1, 1  # Text color
                
                Label:
                    id: email
                    text: 'email@example.com'
                    font_size: '24sp'
                    halign: 'left'
                    valign: 'middle'
                    text_size: self.size
                    color: 1, 1, 1, 1  # Text color

                Label:
                    id: phone
                    text: '+1234567890'
                    font_size: '20sp'
                    halign: 'left'
                    valign: 'middle'
                    text_size: self.size
                    color: 1, 1, 1, 1  # Text color

            BoxLayout:
                orientation: 'vertical'
                size_hint: 0.2, 1
                spacing: dp(10)
                
                Button:
                    text: 'Go Back'
                    size_hint: 1, 0.2
                    pos_hint: {'center_x': 0.5, 'top': 1}
                    background_color: 0.8, 0.2, 0.2, 1  # Button background color
                    color: 1, 1, 1, 1  # Button text color
                    on_release: app.root.current = 'Phome'
                
                Label:
                    text: ''
                    size_hint: 1, 0.8

        Label:
            text: '[b]Your Rides[/b]'
            markup: True
            font_size: '20sp'
            size_hint: 1, 0.05
            halign: 'center'
            valign: 'middle'
            text_size: self.size
            color: 0.2, 0.6, 0.8, 1  # Header text color

        ScrollView:
            id: ridelay
            size_hint: 1, 0.65
            size: root.width, root.height
            do_scroll_x: False
            do_scroll_y: True


            
<ChpwdPass>:
    name: 'chpwdps'
    canvas:
        Rectangle:
            pos: self.pos
            size: self.size
            source: 'background.jpg'
    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'center'
        size_hint: 0.8, 0.8
        spacing: 10
        BoxLayout:
            orientation: 'vertical'
            pos_hint_x: {'center_x'}
            pos_hint_y: {'center_y'}
            Label:
                text: 'Password Reset'
            GridLayout:
                cols: 2
                spacing: 10
                Label:
                    text: 'New Password'
                TextInput:
                    id: newpwd
                    multiline: False
                    password: True
                Label:
                    text: 'Confirm New Password'
                TextInput:
                    id: conpwd
                    multiline: False
                    password: True
                    on_text_validate: root._check_pwd_(newpwd.text, conpwd.text, errormsg)
            BoxLayout:
                orientation: 'horizontal'
                spacing: 10
                Button:
                    text: 'Go Back'
                    size_hint: 0.8, 0.4
                    on_release: app.root.current= 'FPpass'
                Label:
                    id: errormsg
                    text: ''
                Button:
                    text: 'Submit'
                    size_hint: 0.8, 0.4
                    on_release: root._submit_(newpwd.text, conpwd.text, errormsg)


<PassengerHome>:
    name: 'Phome'
    BoxLayout:
        orientation: 'horizontal'
        BoxLayout:
            orientation: 'vertical'
            spacing: 10
            size_hint: 0.1, 1
            Button:
                text: 'Profile'
                size_hint: 1, 0.1
                on_release: app.root.current= 'profile'
            Button:
                text: 'Advanced\n Booking'
                size_hint: 1, 0.1
                on_release: app.root.current= 'advancebook'
            Button:
            	text: 'Help Desk'
            	size_hint: 1, 0.1
            	on_release: app.root.current= 'chat'
            Label:
                size_hint: 1, 0.7
                text: ''
            Button:
                text: 'Logout'
                size_hint: 1, 0.1
                on_release: app.root.current= 'main'
        BoxLayout:
            CustomMapView:
                id: passmap
                size_hint: 0.6, 1
                zoom: 12
                lat: 13.0827
                lon: 80.2707
                MapMarker:
                    id: pickupmarker
                    lat: 0#13.069344
                    lon: 0#80.195203
                    size: '2dp', '2dp'
                    size_hint: 0.1,0.1
                    source: "pickup_pointer.png"
                MapMarker:
                    id: destinationmarker
                    lat: 0#13.0827
                    lon: 0#80.2707
                    size: '2dp', '2dp'
                    size_hint: 0.1, 0.1
                    source: "destination_pointer.png"
        ScrollView:
            do_scroll_x: False
            do_scroll_y: True 
            size_hint: 0.3, 1
            BoxLayout:
                spacing: 10
                padding: [10]
                orientation: 'vertical'
                TextInput:
                    id: pickup
                    hint_text: 'Enter Pick Up Location(double tap to get suggestions)'
                    multiline: False
                    size_hint: 1, 0.2
                    on_double_tap: root.on_text_pickup(self)
                TextInput:
                    id: drop
                    hint_text: 'Enter Destination(double tap to get suggestions)'
                    multiline: False
                    size_hint: 1, 0.2
                    on_double_tap: root.on_text_destination(self)
                Label:
                    id: notify
                    text: 'double tap the text boxes\n to get suggestions'
                    size_hint: 1, 0.2
                RoundedButton:
                    id: suggest1
                    text: ''
                    size_hint: 1, 0.15
                    on_release: root.select_option(self.text, 0, notify)
                RoundedButton:
                    id: suggest2
                    text: ''
                    size_hint: 1, 0.15
                    on_release: root.select_option(self.text, 1, notify)
                RoundedButton:
                    id: suggest3
                    text: ''
                    size_hint: 1, 0.15
                    on_release: root.select_option(self.text, 2, notify)
                Label:
                    id: vehicle
                    text: ''
                    size_hint: 1, 0.2
                AnchorLayout:
                    anchor_y: 'bottom' 
                    GridLayout:
                        size_hint: 1, 1
                        cols: 4
                        Button:
                            id: bike
                            background_normal: 'Bike.png'
                            background_down: 'Bike.png'
                            #text: 'BIKE'
                            font_size: 20
                            size_hint: 0.20, None
                            on_release: root.set_option('bike')
                        Button:
                            id: auto
                            background_normal: 'Auto.png'
                            background_down: 'Auto.png'
                            #text: 'AUTO'
                            font_size: 20
                            size_hint: 0.25, None 
                            on_release: root.set_option('auto')
                        Button:
                            id: mini
                            background_normal: 'Mini-Car.png'
                            background_down: 'Mini-Car.png'
                            #text: 'SEDAN'
                            font_size: 20
                            size_hint: 0.30, None
                            on_release: root.set_option('sedan')
                        Button:
                            id: suv
                            background_normal: 'SUV.png'
                            background_down: 'SUV.png'
                            #text: 'SUV'
                            font_size: 20
                            size_hint: 0.25, None
                            on_release: root.set_option('suv')
                        Label:
                            text: 'BIKE'
                            size_hint: 0.20, None
                        Label:
                            text: 'AUTO'
                            size_hint: 0.25, None
                        Label:
                            text: 'SEDAN'
                            size_hint: 0.30, None
                        Label:
                            text: 'SUV'
                            size_hint: 0.25, None
                Label:
                    id: price_text
                    text: ''
                    font_size: 16
                    size_hint: 1, 0.2
                BoxLayout:
                    id: final
                    orientation: 'horizontal'    
                    Button:
                        id: price
                        text: 'Check Price'
                        size_hint: 1, 0.2
                        on_release: root.generate_price()
                    Button:
                        id: book
                        text: 'Book Now'
                        size_hint: 1, 0.2
                        on_release: root.book_now()

<CancellationScreen>:
    name: 'cancelscreen'
    BoxLayout:
        orientation: 'horizontal'
        BoxLayout:
            orientation: 'vertical'
            size_hint: 0.1, 1
            spacing: 10
            padding: [10]
            canvas.before:
                Color:
                    rgba: 0.95, 0.95, 0.95, 1
                Rectangle:
                    size: self.size
                    pos: self.pos
            Button:
                text: 'Profile'
                size_hint: 1, 0.1
                background_color: (1, 0.2, 0.2, 1)
                color: (1, 1, 1, 1)
                on_release: app.root.current= 'profile'
            Label:
                text: ''
                size_hint: 1, 0.8
            Button:
                text: 'Logout'
                background_color: (1, 0.2, 0.2, 1)
                color: (1, 1, 1, 1)
                size_hint: 1, 0.1
                on_release: app.root.current= 'main'
        BoxLayout:
            CustomMapView:
                id: passmap
                size_hint: 0.6, 1
                zoom: 12
                lat: 13.0827
                lon: 80.2707
                MapMarker:
                    id: pickupmarker
                    lat: 0 #13.069344
                    lon: 0 #80.195203
                    size: '2dp', '2dp'
                    size_hint: 0.1,0.1
                    source: "pickup_pointer.png"
                MapMarker:
                    id: destinationmarker
                    lat: 0 #13.0827
                    lon: 0 #80.2707
                    size: '2dp', '2dp'
                    size_hint: 0.1, 0.1
                    source: "destination_pointer.png"
        BoxLayout:
            orientation: 'vertical'
            canvas.before:
                Color:
                    rgba: 0.95, 0.95, 0.95, 1
                Rectangle:
                    size: self.size
                    pos: self.pos
            size_hint: 0.3, 1
            Label:
                text: 'RIDE CANCELLED\nSUCCESSFULLY'
                markup: True
            Label:
                id: cancelfee
                text: ''
                color: 0.2, 0.2, 0.2, 1
            Button:
                text: 'Go Back'
                size_hint: 1, None
                background_color: (1, 0.2, 0.2, 1)
                color: (1, 1, 1, 1)
                on_release: root.goBack()

<AdvanceBooking>:
    name: 'advancebook'
    BoxLayout:
        orientation: 'horizontal'
        BoxLayout:
            orientation: 'vertical'
            spacing: 10
            size_hint: 0.1, 1
            Button:
                text: 'Profile'
                size_hint: 1, 0.1
                on_release: app.root.current= 'profile'
            Button:
                text: 'Book Now'
                size_hint: 1, 0.1
                on_release: app.root.current= 'Phome'
            Label:
                size_hint: 1, 0.7
                text: ''
            Button:
                text: 'Logout'
                size_hint: 1, 0.1
                on_release: app.root.current= 'main'
        BoxLayout:
            CustomMapView:
                id: passmap
                size_hint: 0.6, 1
                zoom: 12
                lat: 13.0827
                lon: 80.2707
                MapMarker:
                    id: pickupmarker
                    lat: 0 #13.069344
                    lon: 0 #80.195203
                    size: '2dp', '2dp'
                    size_hint: 0.1,0.1
                    source: "pickup_pointer.png"
                MapMarker:
                    id: destinationmarker
                    lat: 0 #13.0827
                    lon: 0 #80.2707
                    size: '2dp', '2dp'
                    size_hint: 0.1, 0.1
                    source: "destination_pointer.png"
        ScrollView:
            id: right_screen
            do_scroll_x: False
            do_scroll_y: True 
            size_hint: 0.3, 1
            BoxLayout:
                spacing: 10
                padding: [10]
                orientation: 'vertical'
                TextInput:
                    id: pickup
                    hint_text: 'Enter Pick Up Location(double tap to get suggestions)'
                    multiline: False
                    size_hint: 1, 0.2
                    on_double_tap: root.on_text_pickup(self)
                    
                TextInput:
                    id: drop
                    hint_text: 'Enter Destination(double tap to get suggestions)'
                    multiline: False
                    size_hint: 1, 0.2
                    on_double_tap: root.on_text_destination(self)
                Label:
                    id: notify
                    text: 'double tap the text boxes\n to get suggestions'
                    size_hint: 1, 0.2
                RoundedButton:
                    id: suggest1
                    text: ''
                    size_hint: 1, 0.15
                    on_release: root.select_option(self.text, 0, notify)
                RoundedButton:
                    id: suggest2
                    text: ''
                    size_hint: 1, 0.15
                    on_release: root.select_option(self.text, 1, notify)
                RoundedButton:
                    id: suggest3
                    text: ''
                    size_hint: 1, 0.15
                    on_release: root.select_option(self.text, 2, notify)

                Label:
                    id: vehicle
                    text: ''
                    size_hint: 1, 0.2
                TextInput:
                    id: date
                    hint_text: 'Date(format: DD-MM-YYYY)'
                    size_hint: 1, 0.2
                TextInput:
                    id: time
                    hint_text: 'Time(24hr format: HH:MM)'
                    size_hint: 1,0.2
                AnchorLayout:
                    anchor_y: 'bottom'
                    GridLayout:
                        size_hint: 1, 1
                        cols: 4
                        Button:
                            id: bike
                            background_normal: 'Bike.png'
                            background_down: 'Bike.png'
                            #text: 'BIKE'
                            font_size: 20
                            size_hint: 0.20, None
                            on_release: root.set_option('bike')
                        Button:
                            id: auto
                            background_normal: 'Auto.png'
                            background_down: 'Auto.png'
                            #text: 'AUTO'
                            font_size: 20
                            size_hint: 0.25, None
                            on_release: root.set_option('auto')
                        Button:
                            id: mini
                            background_normal: 'Mini-Car.png'
                            background_down: 'Mini-Car.png'
                            #text: 'SEDAN'
                            font_size: 20
                            size_hint: 0.30, None
                            on_release: root.set_option('sedan')
                        Button:
                            id: suv
                            background_normal: 'SUV.png'
                            background_down: 'SUV.png'
                            #text: 'SUV'
                            font_size: 20
                            size_hint: 0.25, None
                            on_release: root.set_option('suv')
                        Label:
                            text: 'BIKE'
                            size_hint: 0.25, 0.5
                        Label:
                            text: 'AUTO'
                            size_hint: 0.25, 0.5
                        Label:
                            text: 'SEDAN'
                            size_hint: 0.25, 0.5
                        Label:
                            text: 'SUV'
                            size_hint: 0.25, 0.5
                Label:
                    id: price_text
                    text: ''
                    font_size: 20
                BoxLayout:
                    id: final
                    orientation: 'horizontal'    
                    Button:
                        id: price
                        text: 'Check Price'
                        size_hint: 1, 0.2
                        on_release: root.generate_price()
                    Button:
                        id: book
                        text: 'Book Now'
                        size_hint: 1, 0.2
                        on_release: root.book_advanced()

<RideDetailsScreen>:
    name: 'ridedetails'
    BoxLayout:
        orientation: 'horizontal'
        canvas.before:
            Color:
                rgba: 0.95, 0.95, 0.95, 1
            Rectangle:
                size: self.size
                pos: self.pos
        BoxLayout:
            orientation: 'vertical'
            size_hint: 0.1, 1
            spacing: 10
            padding: [10]
            Button:
                text: 'Profile'
                size_hint: 1, 0.1
                background_color: (1, 0.2, 0.2, 1)
                color: (1, 1, 1, 1)
                on_release: app.root.current= 'profile'
            Button:
                text: 'Go Back'
                size_hint: 1, 0.1
                background_color: (1, 0.2, 0.2, 1)
                color: (1, 1, 1, 1)
                on_release: root.goBack()
            Button:
            	text: 'Chat with Driver'
            	size_hint: 1, 0.1
            	background_color: (1, 0.2,0.2, 1)
            	color: 1,1,1,1
            	on_release: app.root.current= 'driverchat'
            Label:
                text: ''
                size_hint: 1, 0.7
            Button:
                text: 'Logout'
                size_hint: 1, 0.1
                background_color: (1, 0.2, 0.2, 1)
                color: (1, 1, 1, 1)
                on_release: app.root.current= 'main'
        CustomMapView:
            id: bookmap
            size_hint: 0.6, 1
            zoom: 12
            lat: 13.0827
            lon: 80.2707
            MapMarker:
                id: pickupmarker
                lat: 0 #13.069344
                lon: 0 #80.195203
                size: '2dp', '2dp'
                size_hint: 0.1,0.1
                source: "pickup_pointer.png"
            MapMarker:
                id: destinationmarker
                lat: 0 #13.0827
                lon: 0 #80.2707
                size: '2dp', '2dp'
                size_hint: 0.1, 0.1
                source: "destination_pointer.png"
            MapMarker:
                id: driver_loc
                lat: 0
                lon: 0
                size: '2dp', '2dp'
                source: 'taxi.png'
        BoxLayout:
            orientation: 'vertical'
            size_hint: 0.3, 1
            padding: [10, 10, 10, 10]
            spacing: 10
            canvas.before:
                Color:
                    rgba: 0.95, 0.95, 0.95, 1
                Rectangle:
                    size: self.size
                    pos: self.pos

            Label:
                text: '[b]Booking Details[/b]'
                size_hint: 1, 0.2
                markup: True
                font_size: 24
                color: 0.1, 0.1, 0.1, 1

            BoxLayout:
                orientation: 'vertical'
                size_hint: 1, 0.8
                spacing: 5
                padding: [10, 0, 10, 0]

                Label:
                    id: dname
                    text: ''
                    size_hint: 1, 0.1
                    halign: 'center'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1
                    bold: True

                Label:
                    id: dvehicletype
                    text: ''
                    size_hint: 1, 0.1
                    halign: 'center'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1

                Label:
                    id: dvehicleno
                    text: ''
                    size_hint: 1, 0.1
                    halign: 'center'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1
                    bold: True

                Label:
                    id: driver_phone
                    text: ''
                    size_hint: 1, 0.1
                    halign: 'center'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1
                    bold: True

                Label:
                    text: ''
                    size_hint: 1, 0.1

                Label:
                    id: time_of_arrival
                    text: ''
                    size_hint: 1, 0.1
                    halign: 'center'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1
                    markup: True

                Label:
                    id: otp
                    text: ''
                    size_hint: 1, 0.2
                    font_size: "30sp"
                    halign: 'center'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1
                    markup: True

                Label:
                    text: ''
                    size_hint: 1, 0.2

                Label:
                    id: pickup
                    text: 'Pickup Location: '
                    size_hint: 1, 0.1
                    halign: 'left'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1

                Label:
                    id: destination
                    text: 'Destination: '
                    size_hint: 1, 0.1
                    halign: 'left'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1

                Label:
                    text: ''
                    size_hint: 1, 0.2

                Label:
                    id: basefee
                    text: 'Vehicle Base Fee: '
                    size_hint: 1, 0.05
                    halign: 'left'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1

                Label:
                    id: basic
                    text: 'Basic Fare: '
                    size_hint: 1, 0.05
                    halign: 'left'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1

                Label:
                    id: gst
                    text: 'GST: '
                    size_hint: 1, 0.05
                    halign: 'left'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1

                Label:
                    id: convenience
                    text: 'Convenience Fee: '
                    size_hint: 1, 0.05
                    halign: 'left'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1

                Label:
                    id: insurance
                    text: 'Insurance: '
                    size_hint: 1, 0.05
                    halign: 'left'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1

                Label:
                    id: price
                    text: 'Total Price: '
                    size_hint: 1, 0.05
                    halign: 'left'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1

                Label:
                    id: errormsg
                    text: ''
                    size_hint: 1, 0.1

                Label:
                    id: duration
                    text: 'Duration: '
                    size_hint: 1, 0.1
                    halign: 'center'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1

                Label:
                    id: ride_distance
                    text: 'Distance: '
                    size_hint: 1, 0.1
                    halign: 'center'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1
                TextInput:
                    id: rating
                    size_hint: 1, 0.1
                    hint_text: 'Rating (1-5)'
                Label:
                    text: ''
                    size_hint: 1, 0.2
                BoxLayout:
                    orientation: 'horizontal'
                    padding: [5]
                    spacing: 5
                    size_hint: 1, 0.1
                    Button:
                        text: 'Cancel Ride'
                        size_hint: 1, None
                        height: 40
                        on_release: root.cancel_ride()
                        background_color: (1, 0.2, 0.2, 1)
                        color: (1, 1, 1, 1)
                    Button:
                        text: 'End Ride'
                        size_hint: 1, None
                        height: 40
                        on_release: root.end_ride(rating.text)
                        background_color: (1, 0.2, 0.2, 1)
                        color: (1, 1, 1, 1)



<AdvancedRideDetailsScreen>:
    name: 'advancedridedetails'
    BoxLayout:
        orientation: 'horizontal'
        BoxLayout:
            orientation: 'vertical'
            size_hint: 0.1, 1
            spacing: 10
            padding: [10]
            Button:
                text: 'Profile'
                size_hint: 1, 0.1
                background_color: (1, 0.2, 0.2, 1)
                color: (1, 1, 1, 1)
                on_release: app.root.current= 'profile'
            Button:
                text: 'Go Back'
                size_hint: 1, 0.1
                background_color: (1, 0.2, 0.2, 1)
                color: (1, 1, 1, 1)
                on_release: root.goBack()
            Button:
            	text: 'Chat with Driver'
            	size_hint: 1, 0.1
            	background_color: (1, 0.2,0.2, 1)
            	color: 1,1,1,1
            	on_release: app.root.current= 'advanceddriverchat'
            Label:
                text: ''
                size_hint: 1, 0.7
            Button:
                text: 'Logout'
                size_hint: 1, 0.1
                background_color: (1, 0.2, 0.2, 1)
                color: (1, 1, 1, 1)
                on_release: app.root.current= 'main'
        CustomMapView:
            id: bookmap
            size_hint: 0.6, 1
            zoom: 12
            lat: 13.0827
            lon: 80.2707
            MapMarker:
                id: pickupmarker
                lat: 0 #13.069344
                lon: 0 #80.195203
                size: '2dp', '2dp'
                size_hint: 0.1,0.1
                source: "pickup_pointer.png"
            MapMarker:
                id: destinationmarker
                lat: 0 #13.0827
                lon: 0 #80.2707
                size: '2dp', '2dp'
                size_hint: 0.1, 0.1
                source: "destination_pointer.png"
        
        BoxLayout:
            orientation: 'vertical'
            size_hint: 0.3, 1
            padding: [10, 10, 10, 10]
            spacing: 10
            canvas.before:
                Color:
                    rgba: 0.95, 0.95, 0.95, 1
                Rectangle:
                    size: self.size
                    pos: self.pos

            Label:
                text: '[b]Booking Details[/b]'
                size_hint: 1, 0.2
                markup: True
                font_size: 24
                color: 0.1, 0.1, 0.1, 1

            BoxLayout:
                orientation: 'vertical'
                size_hint: 1, 0.8
                spacing: 5
                padding: [10, 0, 10, 0]

                Label:
                    id: dname
                    text: ''
                    size_hint: 1, 0.1
                    halign: 'center'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1
                    bold: True

                Label:
                    id: dvehicletype
                    text: ''
                    size_hint: 1, 0.1
                    halign: 'center'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1

                Label:
                    id: dvehicleno
                    text: ''
                    size_hint: 1, 0.1
                    halign: 'center'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1
                    bold: True

                Label:
                    id: driver_phone
                    text: ''
                    size_hint: 1, 0.1
                    halign: 'center'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1
                    bold: True

                Label:
                    text: ''
                    size_hint: 1, 0.1

                Label:
                    id: time_of_arrival
                    text: ''
                    size_hint: 1, 0.1
                    halign: 'center'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1
                    markup: True

                Label:
                    id: otp
                    text: ''
                    size_hint: 1, 0.2
                    font_size: "30sp"
                    halign: 'center'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1
                    markup: True

                Label:
                    text: ''
                    size_hint: 1, 0.2

                Label:
                    id: pickup
                    text: 'Pickup Location: '
                    size_hint: 1, 0.1
                    halign: 'left'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1

                Label:
                    id: destination
                    text: 'Destination: '
                    size_hint: 1, 0.1
                    halign: 'left'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1

                Label:
                    text: ''
                    size_hint: 1, 0.2
            
                Label:
                    id: basefee
                    text: 'Vehicle Base Fee: '
                    size_hint: 1, 0.1
                    halign: 'left'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1

                Label:
                    id: basic
                    text: 'Basic Fare: '
                    size_hint: 1, 0.1
                    halign: 'left'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1

                Label:
                    id: gst
                    text: 'GST: '
                    size_hint: 1, 0.1
                    halign: 'left'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1

                Label:
                    id: convenience
                    text: 'Convenience Fee: '
                    size_hint: 1, 0.1
                    halign: 'left'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1

                Label:
                    id: insurance
                    text: 'Insurance: '
                    size_hint: 1, 0.1
                    halign: 'left'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1

                Label:
                    id: advance
                    text: 'Advance: '
                    size_hint: 1, 0.1
                    halign: 'left'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1

                Label:
                    id: price
                    text: 'Total Price: '
                    size_hint: 1, 0.1
                    halign: 'left'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1

                Label:
                    text: ''
                    size_hint: 1, 0.2

                Label:
                    id: duration
                    text: 'Duration: '
                    size_hint: 1, 0.1
                    halign: 'center'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1

                Label:
                    id: ride_distance
                    text: 'Distance: '
                    size_hint: 1, 0.1
                    halign: 'center'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1

                Label:
                    text: ''
                    size_hint: 1, 0.2

                Label:
                    text: ''
                    size_hint: 1, 0.1
                    halign: 'center'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1
                
                Label:
                    id: date
                    text: 'Date: '
                    size_hint: 1, 0.1
                    halign: 'left'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1
                
                Label:
                    id: time
                    text: 'Time: '
                    size_hint: 1, 0.1
                    halign: 'left'
                    valign: 'middle'
                    text_size: self.size
                    color: 0.2, 0.2, 0.2, 1

                Button:
                    text: 'Cancel Ride'
                    size_hint: 1, None
                    height: 40
                    on_release: root.cancel_ride()
                    background_color: (1, 0.2, 0.2, 1)
                    color: (1, 1, 1, 1)


<PassMenu@DropDown>:
    Button:
        text: 'Profile'
    
    Button:
        text: 'Your Rides'
    
    Button:
        text: 'Logout'

<CustomMapView>:
    on_zoom: self.redraw_lines()
    on_size: self.redraw_lines()
    on_touch_up: self.redraw_lines()

<RoundedButton@Button>:
    background_color: (0,0,0,0)
    background_normal: ''
    canvas.before:
        Color:
            rgba: (50/255, 47/255, 80/255,0)
        RoundedRectangle:
            size: self.size
            pos: self.pos
            radius: [58]

